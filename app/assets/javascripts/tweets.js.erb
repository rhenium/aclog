Application.Views.tweets = {
    _: function() {
        var formatTweet = function(d) {
            Application.Helpers.localize_time(d);
            Application.Helpers.rescue_profile_image(d);
        };
        formatTweet($(".statuses"));

        if ($("link[rel=next]") !== null) {
            $.autopager({
                content: $(".statuses"),
                link: $("link[rel=next]"),
                onStart: function() {
                    $(".loading").show();
                },
                onReceived: function(obj) {
                    formatTweet(obj);
                },
                onComplete: function() {
                    $(".loading").hide();
                }
            });
        }

        $(".statuses").on("click", ".expand-responses-button", function() {
            var id = $(this).data("id");
            var type = $(this).data("type");
            Application.Helpers.call_api("tweets/responses", { id: id, type: type }, function(json) {
              $(".status[data-id=\"" + id + "\"] .status-responses-" + type).html(json.html);
            });
        });
    }
};
