%html{xmlns: "http://www.w3.org/1999/xhtml"}
  %head
    %title= title
    %meta{name: "viewport", content: "width=device-width"}
    %meta{"http-equiv" => "X-UA-Compatible", content: "IE=edge,chrome=1"}
    %link{rel: "shortcut icon", href: image_path("favicon.ico")}
    %link{rel: "apple-touch-icon-precomposed", href: image_path("apple-touch-icon-precomposed.png")}
    %meta{name: "msapplication-TileImage", content: image_path("tile-image.png")}
    %meta{name: "msapplication-TileColor", content: "#f0eadb"}
    %meta{name: "twitter:widgets:csp", content: "on"}
    %link{rel: "stylesheet", href: asset_path("application.css")}
    %script{src: asset_path("application.js")}
    = csrf_meta_tags
  %body{data: meta_info}
    %nav.navbar.navbar-static-top
      .container
        .nav.navbar-nav.navbar-left
          = link_to root_path, class: "navbar-brand" do
            - if Rails.env.produciton?
              aclog
            - else
              ðŸš§
        %ul.nav.navbar-nav.navbar-right
          %li.dropdown.omittable
            %a.dropdown-toggle{href: "#", data: { toggle: "dropdown" }}<
              All
              %span.caret/
            %ul.dropdown-menu
              %li= link_to "Best", best_path
              %li= link_to "Timeline", timeline_path
              %li.divider
              %li= link_to "API document", about_api_path
              %li= link_to "Current status", status_path
          %li.dropdown.omittable#user-jump-dropdown
            %a.dropdown-toggle{href: "#", data: { toggle: "dropdown", "v-on" => "click: focus" }}<
              User
              %span.caret/
            %ul.dropdown-menu
              %li
                %form{autocomplete: "off", data: {"v-on" => "submit: submit"}}
                  .input-group
                    %input.form-control{type: "text", placeholder: "Username", data: {"v-model" => "enteredUserName", "v-el" => "input"}}
                    %span.input-group-btn
                      %button.btn{type: "submit"} Go
              %template{data: {"v-repeat" => "users"}}
                %li.user-jump-suggestion
                  %a{href: user_path("dummy").sub("dummy", "{{screen_name}}"), title: "{{name | removeInvalidCharacters}} (@{{screen_name}})"}<
                    %img.twitter-icon{alt: "@{{screen_name}}", data: {"v-attr" => "src: profile_image_url", "v-on" => "error: failProfileImage"}}
                    %span @{{screen_name}}
              %li.loading-box{data: {"v-if" => "loading"}}
                %img.loading-image{src: image_path("loading.gif")}
          - if logged_in?
            %li.dropdown
              %a.dropdown-toggle{href: "#", data: { toggle: "dropdown" }}<
                = profile_image_tag current_user, :mini
                %span.caret/
              %ul.dropdown-menu
                %li= link_to "Best", user_path(current_user.screen_name)
                %li= link_to "Timeline", user_timeline_path(current_user.screen_name)
                %li= link_to "Favorites", user_favorites_path(current_user.screen_name)
                %li= link_to "Stats", user_stats_path(current_user.screen_name)
                %li.divider
                %li= link_to "Settings", settings_path
                %li= link_to "Sign out", logout_path, method: :post
          - else
            %li= link_to "Sign in", "/i/login?redirect_after_login=" + CGI.escape(request.fullpath), method: :post, class: "signup"
    = yield
    = render "shared/templates/tweet"
